<div class="loading" ng-show="loading"></div><div ng-hide="loading" class="editReports pages-animation"><div class="title"><ul><li><a ng-href="#/reports">{{ 'REPORTS' | translate }}</a></li><li><span ng-hide="updating">Novo {{ 'REPORT' | translate | lowercase }}</span><span ng-show="updating">Editar {{ 'REPORT' | translate | lowercase }} {{ report.protocol }}</span></li></ul></div><div class="content bigPadding"><h3>1. Selecione um usuário solicitante</h3><div class="form-group clearfix"><users-selector class="pull-left" on-select="onUserSelect(user)"></users-selector><button type="button" class="btn btn-info btn-custom btn-lg-custom pull-left" ng-click="createUser()">+ Cadastrar novo usuário</button></div><div ng-if="user"><p>O relato será vinculado ao usuário:</p><table class="table"><tr><td>Nome</td><td>Email</td><td>CPF</td><td></td></tr><tr><td><strong>{{ user.name }}</strong></td><td>{{ user.email }}</td><td>{{ user.document | cpf }}</td><td class="actions"><a ng-click="editUser()"><span class="glyphicon glyphicon-edit"></span></a> <a ng-click="unselectUser()"><span class="glyphicon glyphicon-remove"></span></a></td></tr></table></div><hr><div ng-show="user" ng-class="{'after-margin': !selectedCategory}" class="pages-animation"><h3>2. Selecione a categoria</h3><div style="width: 40%"><select-list ng-model="selectedCategory" option-name="title"><li ng-repeat="category in $parent.$parent.categories | filter: q" ng-class="{ 'active': isSelected(category.id) }"><a href="" ng-click="select(category.id, category)"><strong><span ng-bind-html="category.title | highlight: q"></span></strong> <b class="glyphicon glyphicon-ok pull-right"></b></a><ul><li ng-repeat="subcategory in category.subcategories | filter: q" ng-class="{ 'active': isSelected(subcategory.id) }"><a href="" ng-click="select(subcategory.id, subcategory)"><span ng-bind-html="subcategory.title | highlight: q"></span> <b class="glyphicon glyphicon-ok pull-right"></b></a></li></ul></li></select-list></div><div ng-show="selectedCategory" class="pages-animation"><hr><h3>3. Preencha o endereço</h3><p>Digite o endereço, ou arraste o pino até a posição exata.</p><div class="row" next-field-on-enter="fieldOnEnter"><div class="search-map col-md-7 col-sm-10 col-xs-12"><span class="loading-automcomplete-request" ng-show="showLoadingForAutocompleteRequest"><i class="refresh glyphicon glyphicon-refresh rotating"></i></span> <input type="name" name="address" class="searchField" placeholder="Logradouro" ng-model="address.address" report-search-map ng-keypress="showLoading()"></div><div class="col-md-2 col-sm-2 col-xs-6"><input type="text" ng-model="address.number" placeholder="N." class="form-control reference-field"></div><div class="col-md-3 col-sm-6 col-xs-6"><input type="text" ng-model="address.reference" placeholder="Referência" class="form-control reference-field"></div><div class="col-md-2 col-sm-6 col-xs-12"><input type="text" ng-model="address.district" placeholder="Bairro" class="form-control reference-field"></div><div class="col-md-2 col-sm-6 col-xs-12"><input type="text" ng-model="address.postal_code" placeholder="CEP" class="form-control reference-field"></div><div class="col-md-3 col-sm-6 col-xs-12"><input type="text" ng-model="address.city" placeholder="Cidade" class="form-control reference-field"></div><div class="col-md-3 col-sm-6 col-xs-6"><input type="text" ng-model="address.state" placeholder="Estado" class="form-control reference-field"></div><div class="col-md-2 col-sm-6 col-xs-6"><input type="text" ng-model="address.country" placeholder="País" class="form-control reference-field"></div></div><hr><p>Mova o marcador para a posição correta do {{ 'REPORT' | translate | lowercase }}.</p><div class="form-group reportMap"><div class="map-alert update-address" ng-show="markerPositionUpdated && !markerOutOfBounds"><a href="" ng-click="updateMarkerAddress()">Clique aqui</a> para atualizar o endereço do relato de acordo com a posição do marcador.</div><div class="map-alert out-of-bounds" ng-show="markerOutOfBounds">O endereço não pertence ao município.</div><div class="loadingMap" ng-show="isLoadingItems"><div class="loadingScrolling"></div></div><div class="roundedMap" map-new-report></div></div><hr><div ng-if="has_custom_fields"><h3>4. Informações adicionais</h3><div class="row" ng-repeat="field in categoryData.custom_fields"><div class="col-md-6 col-sm-8 col-xs-6"><label>{{ field.title }}</label><input ng-if="!field.multiline" type="text" ng-model="custom_fields[field.id]" class="form-control reference-field"><textarea style="height: 150px" ng-if="field.multiline" class="form-control reference-field" ng-model="custom_fields[field.id]"></textarea></div></div></div><h3>{{ has_custom_fields ? 5 : 4 }}. Adicione imagens (opcional)</h3><div class="form-group"><div class="upload" nv-file-drop uploader="uploader"><div class="upload-image" nv-file-over uploader="uploader"><span class="upload-image-span" ng-if="uploader.isHTML5">Arraste as imagens aqui, ou</span><div class="btn btn-info btn-custom btn-upload btn-upload-image"><span>Selecione os arquivos</span> <input type="file" nv-file-select uploader="uploader" multiple="multiple"></div></div></div></div><hr><div ng-repeat="item in uploader.queue" class="animate add-report-images"><div class="table-image-label"><div class="table-cell-image-label first"><div ng-if="uploader.isHTML5" ng-thumb="{ file: item._file, width: 100, height: 100 }"></div><span ng-if="!uploader.isHTML5">{{ item.file.name }}</span></div><div class="table-cell-image-label second"><div class="form-group"><textarea ng-model="item.file.title" class="form-control" placeholder="Adicione uma descrição com até 120 caracteres (opcional)..."></textarea></div></div><div class="table-cell-image-label third"><a href="" ng-click="item.remove()"><span class="glyphicon glyphicon-trash"></span></a></div></div><div class="alerts" ng-show="item.file.title.length > 120"><div class="alert alert-danger pages-animation" role="alert">A descrição da imagem não pode ter mais de 120 caracteres.</div></div><div class="options"><input type="checkbox" bs-switch ng-model="item.file.visibility" switch-on-text="Privado" switch-off-text="Público"> <span class="help">{{ (!item.file.visibility) ? 'Imagens públicas serão visualizadas pelos munícipes.' : 'Imagens privadas não serão visualizadas pelos munícipes.' }}</span></div><hr></div><h3>{{ has_custom_fields ? 6 : 5 }}. Descreva a situação (opcional)</h3><div class="alert alert-danger pages-animation" role="alert" ng-show="description.length > 799">A descrição do relato não pode ter mais de 800 caracteres.</div><textarea class="form-control" placeholder="Descreva o problema aqui..." ng-model="description"></textarea><hr><div class="pull-left"><button ng-click="send()" class="btn btn-info btn-custom btn-lg-custom" ng-disabled="!isReadyToSave()">{{ updating ? 'Atualizar relato' : 'Criar relato' }}</button></div><div class="checkbox pull-left"><label><input type="checkbox" ng-model="createAnother"> Criar outro relato</label></div></div><div class="clearfix"></div></div></div></div>