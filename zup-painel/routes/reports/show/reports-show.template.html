<div class="loading" ng-show="loading"></div><div ng-hide="loading" class="pages-animation"><div class="title"><ul><li><a ng-href="#/reports">{{ 'REPORTS' | translate }}</a></li><li>{{ report.address }}</li></ul><a href="" ng-click="print()" class="btn btn-info btn-custom"><i class="glyphicon glyphicon-print"></i></a> <a href="" ng-click="showNotificationsModal()" class="btn btn-info btn-custom" ng-if="canSendNotifications" promise-btn="retrieveNotificationsPromise">Emitir notificações</a></div><ul class="report-menu" reports-menu><li du-scrollspy="report-group" ng-if="report.grouped"><a href="#report-group" du-smooth-scroll>Relatos agrupados</a></li><li du-scrollspy="report-data"><a href="#report-data" du-smooth-scroll>Dados do {{ 'REPORT' | translate | lowercase }}</a></li><li du-scrollspy="report-notifications" ng-if="report.category.notifications"><a href="#report-notifications" du-smooth-scroll>Notificações emitidas</a></li><li du-scrollspy="report-images"><a href="#report-images" du-smooth-scroll>Imagens</a></li><li du-scrollspy="report-map"><a href="#report-map" du-smooth-scroll>Mapa</a></li><li du-scrollspy="report-streetview"><a href="#report-streetview" du-smooth-scroll>Streetview</a></li><li du-scrollspy="report-author"><a href="#report-author" du-smooth-scroll>Informações do {{ 'REPORT_USER' | translate | lowercase }}</a></li><li du-scrollspy="report-responses" ng-if="show_answer_to_requester"><a href="#report-responses" du-smooth-scroll>Respostas ao {{ 'REPORT_USER' | translate | lowercase }}</a></li><li du-scrollspy="report-comments" ng-show="hasPermission('reports_full_access') || hasPermission('reports_categories_edit', report.category.id) || hasPermission('reports_items_edit', report.category.id) || hasPermission('reports_items_read_private', report.category.id) || hasPermission('reports_items_create_internal_comment', report.category.id)"><a href="#report-comments" du-smooth-scroll>Observações internas</a></li><li du-scrollspy="report-offensive-flags" ng-if="report.offensive_flags.length > 0"><a href="#report-offensive-flags" du-smooth-scroll>Denúncias</a></li><li du-scrollspy="report-history"><a href="#report-history" du-smooth-scroll>Histórico</a></li><div class="clearfix"></div></ul><div class="content wrappers reports-show notifications"><div class="rounder_wrapper" ng-show="report.grouped" id="report-group"><div class="loadingGroupedReports pages-animation" ng-show="loadingGroupedReports"><span></span></div><div class="wrapper_title"><h1>Relatos agrupados</h1></div><div class="fields"><table class="table"><thead><th>Protocolo</th><th>Data de cadastro</th><th>Status</th><th>Descrição</th><th width="290"></th></thead><tbody><tr ng-repeat="gitem in report.grouped_items"><td><strong ng-show="gitem.id === report.id">{{ gitem.id }}</strong> <a ng-show="gitem.id !== report.id" href="#/reports/{{ gitem.id }}"><strong>{{ gitem.id }}</strong></a></td><td>{{ gitem.created_at | date:'dd/MM/yy HH:mm'}}</td><td ng-repeat="status in gitem.category.statuses" ng-show="status.id == gitem.status_id">{{ status.title }}</td><td>{{ gitem.description }}</td><td class=""><div ng-show="(gitem.id === report.id) && hasPermission('reports_items_group')"><button class="btn btn-info btn-custom pull-right" ng-click="ungroupReport(gitem.id)">Desvincular do grupo</button></div><div ng-show="gitem.id !== report.id"><a href="#/reports/{{ gitem.id }}" class="btn btn-info btn-custom">Abrir relato</a> <button class="btn btn-info btn-custom pull-right" ng-show="hasPermission('reports_items_group')" ng-click="ungroupReport(gitem.id)">Desvincular do grupo</button></div></td></tr></tbody></table></div></div><div class="rounder_wrapper" id="related-case" ng-if="report.related_entities.cases"><div class="wrapper_title"><h1>Casos relacionados</h1></div><div class="row" ng-repeat="case in report.related_entities.cases"><div class="left-col"><div class="case-button-container"><i class="glyphicon glyphicon-folder-open"></i> <button class="btn btn-info btn-custom" ng-click="openRelatedCase(case)">Acessar caso</button></div></div><div class="right-col"><label>Nome do caso</label><span>{{ case.flow.title}} #{{ case.id }}</span><div class="clearfix"></div><label>Data de criação</label><span>{{ case.created_at | date:'dd/MM/yy HH:mm'}}</span><div class="clearfix"></div><label>Última atualização</label><span>{{ case.updated_at | date:'dd/MM/yy HH:mm'}}</span><div class="clearfix"></div><label>Estado atual</label><span>{{ case.status}}</span></div></div></div><div class="rounder_wrapper" id="related-case" ng-if="report.related_entities.inventory_items"><div class="wrapper_title"><h1>{{ 'INVENTORIES_RELATED' | translate | lowercase }}</h1></div><div class="row" ng-repeat="item in report.related_entities.inventory_items"><div class="left-col"><div class="case-button-container"><i class="glyphicon glyphicon-folder-open"></i> <button class="btn btn-info btn-custom" ng-click="openRelatedInventoryItem(item)">Acessar {{ 'INVENTORY' | translate | lowercase }}</button></div></div><div class="right-col"><label>Nome</label><span>{{ item.title}} - {{ item.category.title }}</span><div class="clearfix"></div><label>Data de criação</label><span>{{ item.created_at | date:'dd/MM/yy HH:mm'}}</span><div class="clearfix"></div><label>Última atualização</label><span>{{ item.updated_at | date:'dd/MM/yy HH:mm'}}</span><div class="clearfix"></div></div></div></div><div class="rounder_wrapper" id="report-data"><div class="wrapper_title"><h1>Dados do {{ 'REPORT' | translate | lowercase }}</h1></div><div class="status-bar"><div class="background" ng-style="{ 'background-color': report.status.color }"></div><p class="pull-left" ng-style="{ 'color': report.status.color }">{{ report.status.title }}</p><a class="pull-right" ng-click="editReportStatus(report, report.category)" href="" ng-show="hasPermission('reports_full_access') || hasPermission('reports_categories_edit', report.category.id) || hasPermission('reports_items_edit', report.category.id) || hasPermission('reports_items_alter_status', report.category.id)">Alterar estado</a><div class="clearfix"></div></div><div class="fields"><div ng-show="hasPermission('reports_full_access') || hasPermission('reports_categories_edit', report.category.id) || hasPermission('reports_items_edit', report.category.id) || hasPermission('reports_items_read_private', report.category.id)"><h5>Protocolo</h5><p><span>{{ report.protocol }}</span> <span class="label label-danger" ng-show="report.overdue">ATRASADO</span></p><hr></div><div class="report-data"><h5>Endereço</h5><p ng-if="!editingAddress">{{ report.address }}<span ng-if="report.number">, {{ report.number }}</span><span ng-if="report.postal_code">, {{ report.postal_code }}</span><span ng-if="report.district">, {{ report.district }}</span><span ng-if="report.state">- {{ report.state }}</span><span ng-if="report.country">, {{ report.country }}</span></p><div ng-if="editingAddress"><form ng-submit="saveAddress(addressForm)" name="addressForm" novalidate next-field-on-enter="fieldOnEnter"><div class="row"><div class="search-map col-xs-7"><span class="loading-automcomplete-request" ng-show="showLoadingForAutocompleteRequest"><i class="refresh glyphicon glyphicon-refresh rotating"></i></span> <input required name="address" ng-class="{'has-error': addressForm.address.$invalid && (!addressForm.address.$pristine || addressForm.$submitted)}" class="searchField" placeholder="Logradouro" ng-model="address.address" report-search-map ng-keypress="showLoading()"></div><div class="col-xs-2" ng-class="{'has-error': addressForm.number.$invalid && (!addressForm.number.$pristine || addressForm.$submitted)}"><input type="number" ng-model="address.number" name="number" placeholder="N." class="form-control reference-field"></div><div class="col-xs-3" ng-class="{'has-error': addressForm.reference.$invalid && (!addressForm.reference.$pristine || addressForm.$submitted)}"><input type="text" ng-model="address.reference" name="reference" placeholder="Referência" class="form-control reference-field"></div><div class="col-md-2" ng-class="{'has-error': addressForm.district.$invalid && (!addressForm.district.$pristine || addressForm.$submitted)}"><input required type="text" ng-model="address.district" name="district" placeholder="Bairro" class="form-control reference-field"></div><div class="col-md-2" ng-class="{'has-error': addressForm.postal_code.$invalid && (!addressForm.postal_code.$pristine || addressForm.$submitted)}"><input required type="text" ng-model="address.postal_code" name="postal_code" placeholder="CEP" class="form-control reference-field"></div><div class="col-md-3" ng-class="{'has-error': addressForm.city.$invalid && (!addressForm.city.$pristine || addressForm.$submitted)}"><input required type="text" name="city" ng-model="address.city" placeholder="Cidade" class="form-control reference-field"></div><div class="col-md-3" ng-class="{'has-error': addressForm.state.$invalid && (!addressForm.state.$pristine || addressForm.$submitted)}"><input required type="text" name="state" ng-model="address.state" placeholder="Estado" class="form-control reference-field"></div><div class="col-md-2" ng-class="{'has-error': addressForm.country.$invalid && (!addressForm.country.$pristine || addressForm.$submitted)}"><input required type="text" name="country" ng-model="address.country" placeholder="País" class="form-control reference-field"></div></div><div class="form-group reportMap"><div class="map-alert update-address" ng-show="markerPositionUpdated && !markerOutOfBounds"><a href="" ng-click="updateMarkerAddress()">Clique aqui</a> para atualizar o endereço do {{ 'REPORT' | translate | lowercase }} de acordo com a posição do marcador.</div><div class="map-alert out-of-bounds" ng-show="markerOutOfBounds">O endereço não pertence ao município.</div><div class="loadingMap" ng-show="isLoadingItems"><div class="loadingScrolling"></div></div><div class="roundedMap" map-new-report></div></div><div class="pull-right edit-address-actions" ng-if="editingAddress"><a class="btn btn-default btn-fat-custom" ng-click="cancelAddressEdit()" ng-if="!savingAddress">Cancelar</a> <input type="submit" value="Salvar" class="btn btn-info btn-fat-custom btn-custom" ng-disabled="savingAddress"></div></form></div><a href="" class="link" ng-if="!editingAddress" ng-click="editAddress()" ng-show="hasPermission('reports_full_access') || hasPermission('reports_categories_edit', report.category.id) || hasPermission('reports_items_edit', report.category.id)">Editar</a><div class="clearfix"></div></div><div class="report-data"><hr><h5>Referência</h5><p>{{ report.reference }}</p><p ng-show="report.reference == null || report.reference == ''">Não informado.</p><a href="" class="link" ng-click="editReference()" ng-show="hasPermission('reports_full_access') || hasPermission('reports_categories_edit', report.category.id) || hasPermission('reports_items_edit', report.category.id)">Editar</a><div class="clearfix"></div></div><div class="report-data"><hr><h5>Perímetro</h5><p>{{ report.perimeter.title }}</p><p ng-show="report.perimeter == null || report.perimeter == ''">Não informado.</p><div class="clearfix"></div></div><div class="report-data"><hr><h5>Prioridade</h5><p>{{ report.category.priority_pretty }}</p><p ng-show="report.category.priority_pretty == null || report.category.priority_pretty == ''">Não informado.</p><div class="clearfix"></div></div><div class="report-data"><hr><h5>Descrição</h5><p>{{report.description}}</p><p ng-show="report.description == null || report.description == ''">Não informado.</p><a href="" class="link" ng-click="editDescription()" ng-show="hasPermission('reports_full_access') || hasPermission('reports_categories_edit', report.category.id) || hasPermission('reports_items_edit', report.category.id)">Editar</a><div class="clearfix"></div></div><hr><div class="report-data"><h5>{{ 'REPORTS_ATTRIBUTES_CATEGORY' | translate }}</h5><p>{{ report.category.title }}</p><a href="" class="link" ng-click="editCategory()" ng-show="hasPermission('reports_full_access') || hasPermission('reports_categories_edit', report.category.id) || hasPermission('reports_items_edit', report.category.id)">Alterar</a><div class="clearfix"></div></div><hr><h5>Data de cadastro</h5><p>{{ report.created_at | date:'dd/MM/yy HH:mm'}}</p><hr><div class="report-data"><h5>{{ 'REPORTS_ATTRIBUTES_STATUS' | translate }}</h5><p><span>{{ report.status.title }}</span></p><a href="" class="link" ng-click="editReportStatus(report, report.category)" ng-show="hasPermission('reports_full_access') || hasPermission('reports_categories_edit', report.category.id) || hasPermission('reports_items_edit', report.category.id) || hasPermission('reports_items_alter_status', report.category.id)">Alterar</a><div class="clearfix"></div></div><div ng-show="report.inventory_item"><hr><h5>Item relacionado</h5><p><a ng-href="#/items/{{ report.inventory_item.id }}">{{ report.inventory_item.title }}</a></p></div><hr><div class="report-data"><h5>Grupo responsável</h5><p ng-show="report.assigned_group">{{ report.assigned_group.name }}</p><p ng-show="!report.assigned_group">Não há um grupo responsável pelo {{ 'REPORT' | translate | lowercase }}.</p><a href="" class="link" ng-click="forwardReport()" ng-show="(hasPermission('reports_full_access') || hasPermission('reports_categories_edit', report.category.id) || hasPermission('reports_items_edit', report.category.id) || hasPermission('reports_items_forward', report.category.id)) && category.solver_groups_ids.length !== 0">Alterar</a><div class="clearfix"></div></div><div class="report-data" ng-show="report.assigned_group"><hr><h5>Usuário responsável</h5><p ng-show="report.assigned_user">{{ report.assigned_user.name }}</p><p ng-show="!report.assigned_user">Não há um usuário responsável pelo {{ 'REPORT' | translate | lowercase }}.</p><a href="" class="link" ng-click="assignReport()" ng-show="hasPermission('reports_full_access') || hasPermission('reports_categories_edit', report.category.id) || hasPermission('reports_items_edit', report.category.id) || hasPermission('reports_items_forward', report.category.id)">Alterar</a><div class="clearfix"></div></div></div></div><div class="rounder_wrapper" id="custom-fields" ng-if="report.category.custom_fields"><div class="wrapper_title"><h1>Informações extras</h1></div><div class="fields report-data"><div ng-repeat="field in report.custom_fields"><h5>{{field.title}}</h5><p ng-if="field.value">{{field.value}}</p><p ng-if="!field.value">Não informado.</p><a href="" class="link" ng-click="editCustomField(field)" ng-show="hasPermission('reports_full_access') || hasPermission('reports_categories_edit', report.category.id) || hasPermission('reports_items_edit', report.category.id)">Editar</a><div class="clearfix"></div><hr ng-if="$index < report.custom_fields.length - 1"></div></div></div><div class="rounder_wrapper" id="report-notifications" ng-if="report.category.notifications"><div class="wrapper_title"><h1>Notificações emitidas</h1></div><div class="item-history"><div class="empty" ng-show="notifications.length === 0"><p>Não há notificações registradas.</p></div><table class="notifications-history-table" ng-if="notifications.length > 0"><thead><tr><td class="date-cell"><span>Data de emissão</span></td><td class="overdue-cell"><span>Estado</span></td><td class="overdue-cell"><span>Prazo Restante</span></td><td class="overdue-cell"><span>Prazo total</span></td><td class="type-cell"><span>Nome da notificação</span></td><td class="button-cell"></td></tr></thead><tbody><tr ng-repeat="notification in notifications | orderBy: '-created_at'"><td class="date-cell"><span class="date" style="white-space: nowrap">{{notification.created_at | date:'dd/MM/yy HH:mm'}}h</span> <span class="line" ng-if="$index < (report.notifications.length - 1)"></span></td><td class="overdue-cell"><span class="label label-danger" ng-show="notification.active && notification.days_to_deadline < 0">&nbsp;VENCIDO</span> <span class="label label-success" ng-show="notification.active && notification.days_to_deadline >= 0">&nbsp;VIGENTE</span> <span class="label label-success" ng-show="!notification.active" style="background-color: #b3b3b3">&nbsp;CANCELADO</span></td><td class="overdue-cell"><span>{{getDaysTxt(notification.days_to_deadline)}}</span></td><td class="overdue-cell"><span>{{getDaysTxt(notification.notification_type.default_deadline_in_days)}}</span></td><td class="type-cell"><span>{{notification.notification_type.title}}</span></td><td class="button-cell"><div><a href="" class="btn btn-info btn-custom" display-notification="notification.content" style="font-weight: normal"><i class="glyphicon glyphicon-search"></i></a> <a href="" zup-print="notificationToPrint_{{$index}}" class="btn btn-info btn-custom" style="font-weight: normal"><i class="glyphicon glyphicon-print"></i></a><div style="position: absolute; visibility: hidden"><div id="notificationToPrint_{{$index}}" class="a4-page"><div ckeditor="ckeditorDefaultOptions" ng-model="notification.content" contenteditable="true" ng-if="scriptLoaded"></div></div></div></div></td></tr></tbody></table></div></div><div class="rounder_wrapper" id="report-images"><div class="wrapper_title"><div class="row"><div class="col-md-6"><h1>Imagens</h1></div><div class="col-md-6"><button type="button" ng-click="addImages()" class="btn btn-info btn-custom pull-right">Adicionar imagem</button></div></div></div><div class="loadingReportImages pages-animation" ng-show="loadingReportImages"><span></span></div><div class="fields"><div class="images-no-content-message"><p ng-if="!report.images.length" style="text-align: center">Não existem imagens para este relato.</p></div><div class="report-images-galery" ng-repeat="image in report.images" ng-if="report.images.length && $index % 3 === 0"><div ng-repeat="i in [$index, $index+1, $index+2]" class="col-lg-4 col-md-6"><div ng-if="report.images[i]" class="thumbnail"><a href="" class="image-thumb" ng-style="{'background-image': 'url(' + report.images[i].low + ')'}" ng-click="showImageGallery(report.images[i])"></a> <span class="origin">Enviada por {{ (report.images[i].origin === 'citizen') ? 'munícipe' : 'prefeitura' }}</span> <span class="visibility"><i class="fa" ng-class="getVisibilityIcon(report.images[i])" aria-hidden="true"></i> {{ (report.images[i].visibility === 'visible') ? 'Pública' : 'Privada' }}</span><div class="caption"><strong>Data da foto:</strong>&nbsp;<div style="display: inline" ng-class="{ 'unavailable': !report.images[i].date }">{{ (report.images[i].date | date:'dd/MM/yyyy HH:mm') || 'Indisponível' }}</div><div style="word-wrap: break-word" ng-class="{ 'unavailable': !report.images[i].title }">{{ report.images[i].title || 'Descrição não informada.' }}</div></div><div class="actions"><a title="Remover imagem" href="" ng-click="removeImage(report.images[i])" class="icon_action pull-right"><span class="glyphicon glyphicon-trash"></span></a> <a title="Editar imagem" href="" ng-click="editImage(report.images[i])" class="icon_action pull-right"><span class="glyphicon glyphicon-edit"></span></a><div class="clearfix"></div></div></div></div></div><div class="clearfix"></div></div></div><div class="rounder_wrapper" id="report-map" ng-if="report.position"><div class="wrapper_title"><h1>Mapa</h1></div><div class="fields"><div class="roundedMap" map-show-report></div></div></div><div class="rounder_wrapper" id="report-streetview" ng-if="!hideStreetView"><div class="wrapper_title"><h1>Streetview</h1></div><div class="fields"><map-streetview latitude="lat" longitude="lng" icon-format="'marker'" icon-marker="categoryData.marker.retina.web" flag="hideStreetView" class="roundedMap"></map-streetview></div></div><div class="rounder_wrapper" id="report-author"><div class="wrapper_title"><h1>Informações do {{ 'REPORT_USER' | translate | lowercase }}</h1></div><div class="fields"><h5>Nome completo do {{ 'REPORT_USER' | translate | lowercase }}</h5><p ng-show="hasPermission('reports_full_access')"><a href="#/users/{{ report.user.id }}">{{ report.user.name }}</a></p><p ng-show="!hasPermission('reports_full_access')">{{ report.user.name }}</p><hr><h5>Email</h5><p>{{ report.user.email }}</p><hr><h5>Telefone</h5><p>{{ report.user.phone }}</p></div></div><div class="rounder_wrapper" ng-show="feedback" ng-show="hasPermission('reports_full_access') || hasPermission('reports_categories_edit', report.category.id) || hasPermission('reports_items_edit', report.category.id) || hasPermission('reports_items_create_comment', report.category.id) || hasPermission('reports_items_read_private', report.category.id)"><div class="wrapper_title"><h1>Feedback do usuário</h1></div><div class="fields"><h5>Feedback do usuário</h5><p ng-show="feedback.kind == 'positive'">Positivo</p><p ng-show="feedback.kind != 'positive'">Negativo</p><hr><h5>Comentário</h5><p>{{ feedback.content }}</p><hr><div ng-hide="feedback.images.length == 0"><h5>Imagens</h5><gallery images="feedback.images"></gallery><div class="clearfix"></div></div></div></div><div class="rounder_wrapper" id="report-responses" ng-show="hasPermission('reports_full_access') || hasPermission('reports_categories_edit', report.category.id) || hasPermission('reports_items_edit', report.category.id) || hasPermission('reports_items_create_comment', report.category.id) || hasPermission('reports_items_read_private', report.category.id)"><div class="wrapper_title"><h1>Respostas ao municipe</h1></div><div class="fields"><div class="user-message" ng-show="hasPermission('reports_full_access') || hasPermission('reports_categories_edit', report.category.id) || hasPermission('reports_items_edit', report.category.id) || hasPermission('reports_items_create_comment', report.category.id)"><div class="avatar" ng-if="show_answer_to_requester"><img src="assets/images/avatar_default.0eb85571.jpg"></div><div class="infos"><div class="row"><div class="col-md-6"><h2>{{ me.name }}</h2></div><div class="col-md-6"><div class="dropdown phraseologies-select pull-right" ng-show="hasPhraseologies()"><button class="btn btn-default dropdown-toggle" type="button" id="phraseologies" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">Aplicar resposta padrão <span class="caret"></span></button><ul class="dropdown-menu" aria-labelledby="phraseologies"><li ng-repeat="(name, category) in phraseologies"><a><strong>{{ name || 'Respostas globais' }}</strong></a><ul><li ng-repeat="phraseology in category"><a ng-click="applyPhraseology(phraseology)">{{ phraseology.title }}</a></li></ul></li></ul></div></div></div><textarea class="form-control" msd-elastic placeholder="Digite aqui uma resposta..." ng-focus="newUserResponse.typing = true" ng-model="newUserResponse.message" ng-disabled="processingComment"></textarea><div class="options" ng-show="newUserResponse.typing"><input type="checkbox" bs-switch switch-on-text="Privado" switch-off-text="Público" ng-model="newUserResponse.privateComment"> <span class="help">{{ newUserResponse.privateComment == 0 ? 'Respostas públicas podem ser visualizadas por todos os usuários.' : 'Respostas privadas podem ser visualizadas apenas pelo solicitante.' }}</span><div style="display: table; width: 390px; float: right"><div style="display: table-row"><div class="checkbox" style="display: table-cell" ng-show="report.grouped"><label><input type="checkbox" ng-model="report.replicate"> Publicar em todos os relatos do grupo</label></div><div style="display: table-cell"><button href="" class="btn btn-info btn-fat-custom btn-custom pull-right" ng-click="submitUserResponse()" ng-class="{'processing-comment': processingComment }" ng-disabled="processingComment">Enviar</button></div></div></div></div></div><div class="clearfix"></div></div><hr><div class="user-message animate-repeat" ng-repeat="comment in comments | orderBy:'created_at':true | filter: filterByUserMessages"><div class="avatar"><img src="assets/images/avatar_default.0eb85571.jpg"></div><div class="infos"><h2><a ng-href="#/users/{{ comment.author.id }}">{{ comment.author.name }}</a> <span>{{ comment.created_at | date:'dd/MM/yy HH:mm'}} &middot; {{ comment.visibility == 1 ? 'Resposta privada' : 'Resposta pública' }}</span></h2><div marked="comment.message" class="comment-message"></div></div><div class="clearfix"></div><hr></div></div></div><div class="rounder_wrapper" id="report-comments" ng-show="hasPermission('reports_full_access') || hasPermission('reports_categories_edit', report.category.id) || hasPermission('reports_items_edit', report.category.id) || hasPermission('reports_items_read_private', report.category.id) || hasPermission('reports_items_read_private', report.category.id)"><div class="wrapper_title"><h1>Observações internas</h1></div><div class="fields"><div class="user-message system-comment" ng-show="hasPermission('reports_full_access') || hasPermission('reports_categories_edit', report.category.id) || hasPermission('reports_items_edit', report.category.id) || hasPermission('reports_items_create_internal_comment', report.category.id)"><div class="avatar"><img src="assets/images/avatar_default.0eb85571.jpg"></div><div class="infos"><h2>{{ me.name }}</h2><textarea class="form-control" msd-elastic placeholder="Digite aqui uma mensagem..." ng-focus="newSystemComment.typing = true" ng-model="newSystemComment.message" ng-disabled="processingSystemComment"></textarea><div class="options" ng-show="newSystemComment.typing"><div style="display: table; width: 495px; float: right"><div style="display: table-row"><div class="checkbox" style="display: table-cell" ng-show="report.grouped"><label><input type="checkbox" ng-model="report.replicate"> Publicar em todos os relatos do grupo</label></div><div style="display: table-cell"><button href="" class="btn btn-info btn-fat-custom btn-custom pull-right" ng-click="submitSystemComment()" ng-class="{'processing-comment': processingSystemComment }" ng-disabled="processingSystemComment">Publicar internamente</button></div></div></div></div></div><div class="clearfix"></div></div><hr><div class="user-message animate-repeat system-comment" ng-repeat="comment in comments | orderBy:'created_at':true | filter: {visibility: 2}"><div class="avatar"><img src="assets/images/avatar_default.0eb85571.jpg"></div><div class="infos"><h2><a ng-href="#/users/{{ comment.author.id }}">{{ comment.author.name }}</a> <span>{{ comment.created_at | date:'dd/MM/yy HH:mm'}}</span></h2><div marked="comment.message" class="comment-message"></div></div><div class="clearfix"></div><hr></div></div></div><div class="rounder_wrapper" id="report-offensive-flags" ng-hide="report.offensive_flags.length === 0"><div class="wrapper_title"><h1>Denúncias</h1></div><div class="item-history"><div class="timeline"><div class="line"><span></span></div><div class="log" ng-repeat="item in report.offensive_flags"><div class="date"><span>{{ item.created_at | date:'dd/MM/yy HH:mm'}}h</span></div><div class="action"><p><a ng-href="#/users/{{ item.user.id }}" ng-if="item.user">{{ item.user.name }}</a> <span>marcou como inapropriado.</span></p><div class="divider"></div></div><div class="clearfix"></div></div></div></div></div><div class="rounder_wrapper" id="report-history"><div class="wrapper_title"><h1>Histórico</h1></div><div class="item-history"><div class="filters"><div class="filter col-xs-3"><b>Exibir</b><div class="btn-group"><button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-expanded="false"><span class="pull-left">Tipos</span> <span class="pull-right"><span class="caret"></span></span></button><ul class="dropdown-menu" role="menu"><li ng-repeat="filter in availableHistoryFilters"><a href="" ng-click="toggleOption(filter)"><b class="glyphicon glyphicon-ok" ng-show="filter.selected"></b> {{ filter.name }}</a></li><li class="last"><a href="" ng-click="resetHistoryFilters()">Marcar todos</a></li></ul></div></div><div class="filter period col-xs-3"><b>Período</b><div class="btn-group"><button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-expanded="false"><span class="pull-left">Data</span> <span class="pull-right"><span class="caret"></span></span></button><ul class="dropdown-menu" role="menu"><li ng-repeat="filter in availableHistoryDateFilters" ng-class="{'active': filter.selected }"><a href="" ng-click="selectDateFilter(filter)">{{ filter.name }}</a></li><li class="divider"></li><li ng-class="{ 'active': showCustomDateHelper }"><a href="" ng-click="showCustomDateFields()">Por período</a></li></ul></div></div><div class="filter datepicker col-xs-2 pages-animation" ng-show="showCustomDateHelper"><input type="text" class="form-control" datepicker-popup="dd/MM/yyyy" ng-model="historyFilterBeginDate" show-weeks="false" show-button-bar="false" ng-change="refreshHistory()"></div><span class="filter until col-xs-1 pages-animation" ng-show="showCustomDateHelper">até</span><div class="filter datepicker last col-xs-2" ng-show="showCustomDateHelper"><input type="text" class="form-control" datepicker-popup="dd/MM/yyyy" ng-model="historyFilterEndDate" show-weeks="false" show-button-bar="false" ng-change="refreshHistory()"></div><div class="clearfix"></div></div><div class="timeline"><div class="loadingHistoryLogs pages-animation" ng-show="loadingHistoryLogs"><span></span></div><div class="empty" ng-show="historyLogs.length === 0"><p>Não há alterações cadastradas.</p></div><div class="line"><span></span></div><div class="log" ng-repeat="log in historyLogs"><div class="date"><span>{{ log.created_at | date:'dd/MM/yy HH:mm'}}h</span></div><div class="action"><p><a ng-href="#/users/{{ log.user.id }}" ng-if="log.user">{{ log.user.name }}</a> <span ng-if="!log.user && (log.kind !== 'overdue' && log.kind !== 'perimeter')">O sistema</span> <span ng-show="log.kind === 'status' && log.user">alterou o estado do {{ 'REPORT' | translate | lowercase }} de <b>{{ log.changes.old.title }}</b> para <b>{{ log.changes.new.title }}</b>.</span> <span ng-show="log.kind === 'status' && !log.user">alterou o estado do {{ 'REPORT' | translate | lowercase }} de <b>{{ log.changes.old.title }}</b> para <b>{{ log.changes.new.title }}</b>.</span> <span ng-show="log.kind === 'overdue'">O {{ 'REPORT' | translate | lowercase }} entrou em atraso às <b>{{ log.created_at | date:'HH:mm'}}</b> quando estava no estado: <b>{{ overdue_status }}</b>.</span> <span ng-show="log.kind === 'address'">alterou o endereço do {{ 'REPORT' | translate | lowercase }} para <b>{{ log.changes.new }}</b>.</span> <span ng-show="log.kind === 'description'">alterou a descrição do {{ 'REPORT' | translate | lowercase }} para <b>{{ log.changes.new }}</b>.</span> <span ng-show="log.kind === 'reference'">alterou a referência do {{ 'REPORT' | translate | lowercase }} de <b>{{ log.changes.old }}</b> para <b>{{ log.changes.new }}</b>.</span> <span ng-show="log.kind === 'category'">alterou a categoria do {{ 'REPORT' | translate | lowercase }} de <b>{{ log.changes.old.title }}</b> para <b>{{ log.changes.new.title }}</b>.</span> <span ng-show="log.kind === 'user_assign'">associou o {{ 'REPORT' | translate | lowercase }}<span ng-show="log.changes.old">do usuário <a ng-href="#/groups/{{ log.changes.old.id }}">{{ log.changes.old.name }}</a></span> para o usuário <a ng-href="#/users/{{ log.changes.new.id }}">{{ log.changes.new.name }}</a>.</span> <span ng-show="log.kind === 'forward'">encaminhou o {{ 'REPORT' | translate | lowercase }} <span ng-show="log.changes.old">do grupo <a ng-href="#/groups/{{ log.changes.old.id }}">{{ log.changes.old.name }}</a></span> para o grupo <a ng-href="#/groups/{{ log.changes.new.id }}">{{ log.changes.new.name }}</a>.</span> <span ng-show="log.kind === 'comment' && log.changes.new.visibility == 0">inseriu uma resposta pública ao solicitante: <b>{{ log.changes.new.message }}</b>.</span> <span ng-show="log.kind === 'comment' && log.changes.new.visibility == 1">inseriu uma resposta privada ao solicitante: <b>{{ log.changes.new.message }}</b>.</span> <span ng-show="log.kind === 'comment' && log.changes.new.visibility == 2">inseriu o comentáro interno: <b>{{ log.changes.new.message }}</b>.</span> <span ng-show="log.kind === 'create_image'">criou uma nova imagem</span> <span ng-show="log.kind === 'remove_image'">removeu uma imagem</span> <span ng-show="log.kind === 'update_image'">atualizou uma imagem</span> <span ng-show="log.kind === 'add_image'">adicionou uma imagem</span> <span ng-if="log.kind === 'perimeter'">{{log.action}}</span> <span ng-show="log.kind === 'creation'">criou o {{ 'REPORT' | translate | lowercase }} com o estado <b>{{ log.changes.new.title }}</b>.</span> <span ng-show="log.kind === 'notification'">emitiu a notificação <b>{{ log.changes.new.title }}</b>.</span> <span ng-show="log.kind === 'notification_restart'">reiniciou o processo de notificações.</span></p><div class="divider"></div></div><div class="clearfix"></div></div></div></div></div></div></div>